{"version":3,"sources":["uni-app:///main.js",null,"webpack:////Users/jiaozi030/Desktop/app/QiuQiu/pages/message/message.vue?ec78","webpack:////Users/jiaozi030/Desktop/app/QiuQiu/pages/message/message.vue?ddb9","webpack:////Users/jiaozi030/Desktop/app/QiuQiu/pages/message/message.vue?a799","uni-app:///pages/message/message.vue","webpack:////Users/jiaozi030/Desktop/app/QiuQiu/pages/message/message.vue?b614","webpack:////Users/jiaozi030/Desktop/app/QiuQiu/pages/message/message.vue?5207"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","messages","created","uniCloud","name","userId","res","console","filteredResult","chatId","avatar","username","latestMessage","time","methods","navigateToChat","uni","url","fetchMessages","senderId","content"],"mappings":";;;;;;;;;;;;;AAAA;AAE2D;AAC3D;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,gBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAoH;AACpH;AAC2D;AACL;AACa;;;AAGnE;AACgN;AAChN,gBAAgB,iNAAU;AAC1B,EAAE,6EAAM;AACR,EAAE,kFAAM;AACR,EAAE,2FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,sFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAq0B,CAAgB,qyBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;ACkCz1B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAEA;EACAC;IACA;MACAC;IACA;EACA;EACAC;IAAA;IAAA;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;cAAA;cAAA,OAEAC;gBACAC;gBACAJ;kBACAK;gBACA;cACA;YAAA;cALAC;cAOAC;;cAEA;gBACAC;kBAAA;oBACAC;oBAAA;oBACAC;oBAAA;oBACAC;oBAAA;oBACAC;oBAAA;oBACAC;kBACA;gBAAA;;gBAEAN;gBAEA;gBAEAA;cACA;gBACAA;cACA;cAAA;cAAA;YAAA;cAAA;cAAA;cAEAA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA;EAEA;EACAO;IACAC;MACA;QACAR;QACA;MACA;;MAEAS;QACAC;MACA;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA;gBAAA,OAEAf;kBACAC;kBAAA;kBACAJ;oBAAAS;kBAAA;gBACA;cAAA;gBAHAH;gBAKA;kBACA;oBAAA;sBACAa;sBACAC;sBACAV;sBAAA;sBACAG;oBACA;kBAAA;gBACA;kBACAN;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC3GA;AAAA;AAAA;AAAA;AAAkrC,CAAgB,kmCAAG,EAAC,C;;;;;;;;;;;ACAtsC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/message/message.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;import '@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js';\nimport Vue from 'vue'\nimport Page from './pages/message/message.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./message.vue?vue&type=template&id=a91f51d4&\"\nvar renderjs\nimport script from \"./message.vue?vue&type=script&lang=js&\"\nexport * from \"./message.vue?vue&type=script&lang=js&\"\nimport style0 from \"./message.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/message/message.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./message.vue?vue&type=template&id=a91f51d4&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./message.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./message.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"message-page\">\n    <!-- 按钮区域 -->\n    <view class=\"button-group\">\n      <view class=\"button-item\" @click=\"navigateToFollowers\">\n        <image src=\"/static/default/red-heart.jpg\" class=\"button-icon\" />\n        <text class=\"button-text\">谁关注我</text>\n      </view>\n      <view class=\"button-item\" @click=\"navigateToViewers\">\n        <image src=\"/static/default/white-heart.jpg\" class=\"button-icon\" />\n        <text class=\"button-text\">谁看过我</text>\n      </view>\n    </view>\n\n    <!-- 消息列表 -->\n    <view class=\"message-list\">\n      <view\n        v-for=\"(message, index) in messages\"\n        :key=\"index\"\n        class=\"message-item\"\n        @click=\"navigateToChat(message)\"\n      >\n        <image :src=\"message.avatar || '/static/default/logo.png'\" class=\"avatar\" />\n        <view class=\"message-content\">\n          <text class=\"username\">{{ message.username || '未知用户' }}</text>\n          <text class=\"latest-message\">{{ message.latestMessage || '暂无消息' }}</text>\n        </view>\n        <text class=\"message-time\">{{ message.time || '' }}</text>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\nimport { sampleMessages } from '@/data/sampleMessages.js';\n\nexport default {\n  data() {\n    return {\n      messages: []\n    };\n  },\n  async created() {\n    try {\n      const res = await uniCloud.callFunction({\n        name: 'chat',\n        data: {\n          userId: '67d16f8ae0ec19c842704b02' // 替换为实际用户 ID\n        }\n      });\n\n      console.log('云函数返回的数据:', res); // 检查云函数返回的数据\n\n      if (res.result.code === 200) {\n        const filteredResult = res.result.data.map(chat => ({\n          chatId: chat.chatId, // 确保 chatId 被正确设置\n          avatar: chat.avatar || '/static/default/logo.png', // 设置默认头像\n          username: chat.username || '未知用户', // 设置默认昵称\n          latestMessage: chat.latestMessage || '暂无消息', // 设置默认消息内容\n          time: new Date(chat.time).toLocaleString() // 格式化时间\n        }));\n\n        console.log('返回的聊天数据:', filteredResult);\n\n        this.messages = filteredResult;\n\n        console.log('处理后的消息列表:', this.messages); // 检查处理后的数据\n      } else {\n        console.error('云函数返回错误:', res.result.message);\n      }\n    } catch (error) {\n      console.error('获取聊天列表失败:', error);\n    }\n  },\n  methods: {\n    navigateToChat(message) {\n      if (!message.chatId) {\n        console.error('chatId 未定义:', message);\n        return; // 防止跳转到不存在的页面\n      }\n\n      uni.navigateTo({\n        url: `/pages/message/chat?chatId=${message.chatId}`\n      });\n    },\n    async fetchMessages(chatId) {\n      try {\n        const res = await uniCloud.callFunction({\n          name: 'message', // 云函数名称\n          data: { chatId } // 传入 chatId\n        });\n\n        if (res.result.code === 200) {\n          this.messages = res.result.data.map(message => ({\n            senderId: message.senderId,\n            content: message.content,\n            avatar: message.avatar || '/static/default/logo.png', // 设置默认头像\n            time: new Date(message.createdAt).toLocaleString()\n          }));\n        } else {\n          console.error('云函数返回错误:', res.result.message);\n        }\n      } catch (error) {\n        console.error('获取消息失败:', error);\n      }\n    }\n  }\n};\n</script>\n\n<style>\n.message-page {\n  padding: 20px;\n  display: flex;\n  flex-direction: column;\n  gap: 5px;\n}\n.content {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100vh;\n}\n\n.title {\n  font-size: 36rpx;\n  color: #8f8f94;\n}\n\n.button-group {\n  display: flex;\n  justify-content: space-around;\n  margin-bottom: 20px;\n}\n\n.button-item {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  cursor: pointer;\n  width: 80%; /* 设置按钮宽度 */\n  padding: 1px;\n  border: 1px solid rgb(233, 231, 169); /* 可选：添加边框 */\n  border-radius: 8px; /* 可选：圆角 */\n  background-color: 0; /* 可选：背景色 */\n}\n\n.button-icon {\n  width: 50px; /* 图标大小 */\n  height: 50px;\n  margin-bottom: 2px;\n}\n\n.button-text {\n  font-size: 14px;\n  color: #333;\n}\n.message-list {\n  display: flex;\n  flex-direction: column;\n  gap: 10px; /* 消息框之间的间距 */\n}\n\n.message-item {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  padding: 15px;\n  border: 1px solid #eee;\n  border-radius: 8px;\n  background-color: #fff;\n  position: relative; /* 为了定位时间 */\n  min-height: 110px; /* 设置消息框的最小高度，确保统一 */\n  box-sizing: border-box; /* 包括内边距在内计算高度 */\n}\n\n.avatar {\n  width: 50px;\n  height: 50px;\n  border-radius: 50%;\n}\n\n.message-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 5px;\n  overflow: hidden; /* 防止内容超出 */\n}\n\n.username {\n  font-size: 16px;\n  font-weight: bold;\n  color: #333;\n  white-space: nowrap; /* 防止用户名换行 */\n  overflow: hidden;\n  text-overflow: ellipsis; /* 超出部分显示省略号 */\n}\n\n.latest-message {\n  font-size: 14px;\n  color: #666;\n  white-space: nowrap; /* 防止消息内容换行 */\n  overflow: hidden;\n  text-overflow: ellipsis; /* 超出部分显示省略号 */\n}\n\n.message-time {\n  position: absolute; /* 绝对定位时间 */\n  bottom: 10px; /* 距离底部 */\n  right: 15px; /* 距离右侧 */\n  font-size: 12px; /* 时间字体较小 */\n  color: #999; /* 时间颜色较浅 */\n  white-space: nowrap; /* 防止时间换行 */\n}\n</style>","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./message.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./message.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1743393101873\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}